# Application
APP_NAME=cerberus
APP_ENV=development
DEBUG=true
LOG_LEVEL=INFO

# Server
HOST=0.0.0.0
PORT=8000

# Database
DATABASE_URL=postgresql+asyncpg://postgres:postgres@localhost:5432/cerberus
DATABASE_POOL_SIZE=20
DATABASE_MAX_OVERFLOW=10

# Migrations
# When true, runs alembic migrations automatically on app startup
# Uses PostgreSQL advisory lock to prevent race conditions with multiple instances
RUN_MIGRATIONS_ON_STARTUP=true

# Redis
REDIS_URL=redis://localhost:6379/0
REDIS_POOL_SIZE=10

# Security
SECRET_KEY=your-secret-key-change-in-production
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_DAYS=7
API_KEY_PREFIX=sk-

# CORS
CORS_ORIGINS=["http://localhost:3000"]

# MCP Proxy Settings (replaces http-gateway)
MCP_REQUEST_TIMEOUT_SECONDS=30.0
MCP_MAX_RETRIES=2
MCP_MAX_KEEPALIVE_CONNECTIONS=20
MCP_MAX_CONNECTIONS=100

# Proxy Header Forwarding Configuration
# When true, forwards the original Authorization header to upstream MCP server
PROXY_FORWARD_AUTHORIZATION=true
# Headers to forward from client to upstream (comma-separated, in addition to standard ones)
# Example: PROXY_FORWARD_HEADERS=X-Custom-Header,X-Another-Header
PROXY_FORWARD_HEADERS=
# Headers to NEVER forward (security-sensitive), comma-separated
PROXY_BLOCKED_HEADERS=cookie,set-cookie,x-api-key
# When true, forwards ALL client headers except blocked ones (use with caution)
PROXY_FORWARD_ALL_HEADERS=false

# Cerberus Headers (added by proxy to upstream requests)
PROXY_TENANT_ID_HEADER=X-Tenant-ID
PROXY_WORKSPACE_ID_HEADER=X-Workspace-ID
PROXY_USER_ID_HEADER=X-User-ID
PROXY_REQUEST_ID_HEADER=X-Gateway-Request-ID
PROXY_FORWARDED_FOR_HEADER=X-Forwarded-For

# Rate Limiting Defaults
DEFAULT_RATE_LIMIT_PER_MINUTE=100
DEFAULT_RATE_LIMIT_PER_HOUR=1000

# Decision Engine
DECISION_TIMEOUT_MS=5000
FAIL_MODE=closed

# Feature Flags
ENABLE_PII_DETECTION=true
ENABLE_SECRETS_DETECTION=true
ENABLE_CONTENT_FILTER=true
ENABLE_DLP=true

